<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bloxd.io Pack Utils</title>
    <style>
        /* Styles comme précédemment */
    </style>
</head>
<body>
    <div id="header">
        <h1>Welcome to Bloxd.io Pack Utils</h1>
        <button id="loginButton" onclick="toggleLogin()">Login / Sign Up</button>
        <img id="profilePic" src="https://via.placeholder.com/40" alt="Profile Picture" title="Change Profile Picture" style="display: none; cursor: pointer;">
        <input type="file" id="profilePicInput" style="display: none;" accept="image/*" onchange="changeProfilePic(event)">
        <input type="text" id="searchInput" placeholder="Search packs..." oninput="searchPacks()">
    </div>

    <div id="packs"></div>

    <div id="addPackForm" style="display: none; margin: 20px;">
        <h3>Publier un nouveau pack</h3>
        <input type="text" id="newPackTitle" placeholder="Titre du pack" required>
        <textarea id="newPackDescription" placeholder="Description du pack" required></textarea>
        <input type="file" id="newPackImage" accept="image/*">
        <button onclick="publishPack()">Publier</button>
    </div>

    <div id="modal" class="modal">
        <!-- Modale des packs -->
    </div>

    <script>
        let packs = JSON.parse(localStorage.getItem('packs')) || [
            { title: "Pack 1", image: "https://via.placeholder.com/150", description: "Description 1", downloads: 100, views: 200, rating: 4.5, comments: [] },
            { title: "Pack 2", image: "https://via.placeholder.com/150", description: "Description 2", downloads: 200, views: 300, rating: 4.0, comments: [] },
            { title: "Pack 3", image: "https://via.placeholder.com/150", description: "Description 3", downloads: 300, views: 400, rating: 3.5, comments: [] },
        ];

        // Afficher les packs au chargement de la page
        displayPacks();

        function displayPacks() {
            const packsContainer = document.getElementById('packs');
            packsContainer.innerHTML = '';
            packs.forEach((pack, index) => {
                const packDiv = document.createElement('div');
                packDiv.classList.add('pack');
                packDiv.innerHTML = `
                    <h3>${pack.title}</h3>
                    <img src="${pack.image}" alt="${pack.title}">
                    <p><strong>Downloads:</strong> ${pack.downloads}</p>
                    <p><strong>Views:</strong> ${pack.views}</p>
                    <p><strong>Rating:</strong> ${pack.rating}</p>
                    <button onclick="openModal(${index})">View Details</button>
                `;
                packsContainer.appendChild(packDiv);
            });
        }

        function publishPack() {
            const title = document.getElementById('newPackTitle').value;
            const description = document.getElementById('newPackDescription').value;
            const imageFile = document.getElementById('newPackImage').files[0];

            if (title && description && imageFile) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    const newPack = {
                        title: title,
                        description: description,
                        image: event.target.result,
                        downloads: 0,
                        views: 0,
                        rating: 0,
                        comments: []
                    };
                    packs.push(newPack);
                    localStorage.setItem('packs', JSON.stringify(packs));
                    displayPacks();
                    document.getElementById('newPackTitle').value = '';
                    document.getElementById('newPackDescription').value = '';
                    document.getElementById('newPackImage').value = '';
                    alert("Pack publié avec succès !");
                };
                reader.readAsDataURL(imageFile);
            } else {
                alert("Veuillez remplir tous les champs.");
            }
        }

        function toggleLogin() {
            const isLoggedIn = localStorage.getItem('username');
            if (isLoggedIn) {
                alert(`Bienvenue, ${isLoggedIn}!`);
                showProfile();
                document.getElementById('addPackForm').style.display = 'block';
            } else {
                const username = prompt("Nom d'utilisateur :");
                const password = prompt("Mot de passe :");
                if (username && password) {
                    localStorage.setItem('username', username);
                    alert("Compte créé !");
                    showProfile();
                    document.getElementById('addPackForm').style.display = 'block';
                } else {
                    alert("Nom d'utilisateur et mot de passe requis.");
                }
            }
        }

        function showProfile() {
            const profilePic = document.getElementById('profilePic');
            const savedProfilePic = localStorage.getItem('profilePic');
            if (savedProfilePic) {
                profilePic.src = savedProfilePic;
            }
            profilePic.style.display = 'inline-block';
            profilePic.onclick = () => document.getElementById('profilePicInput').click();
            document.getElementById('loginButton').style.display = 'none';
        }

        function changeProfilePic(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const profilePicUrl = e.target.result;
                    document.getElementById('profilePic').src = profilePicUrl;
                    localStorage.setItem('profilePic', profilePicUrl);
                    alert("Photo de profil mise à jour !");
                };
                reader.readAsDataURL(file);
            }
        }

        // Récupérer la photo de profil et afficher le formulaire de publication si l'utilisateur est connecté
        if (localStorage.getItem('username')) {
            showProfile();
            document.getElementById('addPackForm').style.display = 'block';
        }
    </script>
</body>
</html>
